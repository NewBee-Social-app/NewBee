<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="./style.css" />
    
    <title>NewBee!</title>
</head>
<body>
    <div class="hero">
        <nav>
           <img src="./roundlogoOri.png" class="logo">
           <ul>
               
               <li><a href="/about">ABOUT US</a></li>
               <li><a href="/logout">LOGOUT</a></li>
           </ul>
        </nav>
        <div class="content">
            <h1>Welcome to your dashboard</h1>
            <a  id='seewhatsnew' href="/vites" onclick="handleSeewhatsNewClick(event)">See whats new in town</a>
           
            <a  href="create.html">Create your event</a>
            </div>
            
<script >
     //func
  function handleSeewhatsNewClick(event){
    event.preventDefault()
    const urlParams = new URLSearchParams(window.location.search)
    const token = urlParams.get('token')
    console.log('token:',token)
    if(token){
        fetch('http://localhost:3000/vites',{
            method: 'GET',
            headers:{
                'Authorization': `Bearer ${token}`
            }
        })
        .then(response =>{
            if(response.ok){
                return response.json()
            }else{
                throw new Error('Request failed with status:' + response.status);
            }
        })
        .then(data=>{
            console.log(data)
            
            // window.location.href=`/vite.html?data=${encodeURIComponent(JSON.stringify(data))}`
        })
        .catch(error =>{
            console.error(error)
        })

            }else{
        console.log('Token not found')
        
    }
}
</script> 
            
          </body>
        </body>
        </html>
